<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="report">

<select id="selectReportRoomList" parameterType="hashmap" resultType="hashmap"> 
	<![CDATA[
	SELECT
		ROW_NUMBER() OVER (ORDER BY REPORT_NUM ASC) RNUM,
		REPORT_NUM,
		REPORT_ID,
		REPORT_D_ID,
		REPORT_POST_NUM,
		REPORT_DATE,
		REPORT_TYPE,
		REPORT_TITLE		
	FROM
		REPORT
	]]>	
	<choose>
	<when test="ReportType==1">
	<![CDATA[
	WHERE 
		REPORT_TYPE = '욕설 및 혐오발언' AND REPORT_POST_NUM IS NOT NULL
	]]>	
	</when>
	<when test="ReportType==2">
	<![CDATA[
	WHERE 
		REPORT_TYPE = '허위정보 기재' AND REPORT_POST_NUM IS NOT NULL
	]]>	
	</when>
	<when test="ReportType==3">
	<![CDATA[
	WHERE 
		REPORT_TYPE = '음란성 게시글' AND REPORT_POST_NUM IS NOT NULL
	]]>	
	</when>
	<when test="ReportType==4">
	<![CDATA[
	WHERE 
		REPORT_TYPE = '도배/광고' AND REPORT_POST_NUM IS NOT NULL
	]]>	
	</when>
	<otherwise>
	<![CDATA[
	WHERE 
		REPORT_POST_NUM IS NOT NULL
	]]>	
	</otherwise>
	</choose>
</select>

<select id="selectReportMateList" parameterType="hashmap" resultType="hashmap"> 
	<![CDATA[
	SELECT
		ROW_NUMBER() OVER (ORDER BY REPORT_NUM ASC) RNUM,
		REPORT_NUM,
		REPORT_ID,
		REPORT_D_ID,
		REPORT_DATE,
		REPORT_TYPE,
		REPORT_TITLE
	FROM
		REPORT
	where
		REPORT_POST_NUM IS NULL
	]]>
</select>

<select id="selectReportMateDetail" parameterType="hashmap" resultType="hashmap"> 
	<![CDATA[
	SELECT
		ROW_NUMBER() OVER (ORDER BY REPORT_NUM ASC) RNUM,
		REPORT_NUM,
		REPORT_ID,
		REPORT_D_ID,
		REPORT_DATE,
		REPORT_REASON,
		REPORT_TYPE,
		REPORT_TITLE
	FROM
		REPORT P, MEMBER M
	WHERE
	 	P.REPORT_ID = M.MEM_ID 
	AND
		REPORT_NUM = #{REPORT_NUM}
	]]>
</select>

<select id="selectReportRoomDetail" parameterType="hashmap" resultType="hashmap"> 
	<![CDATA[
	SELECT
		ROW_NUMBER() OVER (ORDER BY REPORT_NUM ASC) RNUM,
		REPORT_NUM,
		REPORT_ID,
		REPORT_D_ID,
		REPORT_POST_NUM,
		REPORT_DATE,
		REPORT_REASON,
		REPORT_TYPE,
		REPORT_TITLE,
		MEM_NUM
	FROM
		REPORT P, MEMBER M
	WHERE
	 	P.REPORT_ID = M.MEM_ID 
	AND
		REPORT_NUM = #{REPORT_NUM}
	]]>
</select>


<!-- 밑에껀 멤버가 신고하는거 -->
<select id="insertReport" parameterType="hashmap"> 
	<![CDATA[
	INSERT INTO REPORT (
		ROW_NUMBER() OVER (ORDER BY REPORT_NUM DESC) RNUM,
		REPORT_ID,
		REPORT_D_ID,
		REPORT_POST_NUM,
		REPORT_TITLE,
		REPORT_REASON,
		REPORT_TYPE,
		REPORT_TITLE
		) 
	VALUES(
		REPORT_NUM_SEQ.NEXTVAL,
		#{REPORT_ID},
		#{REPORT_D_ID},
		#{REPORT_POST_NUM},
		#{REPORT_TITLE},
		#{REPORT_REASON},
		#{REPORT_TYPE},
		#{REPORT_TITLE}
	)
	]]>
</select>

<!-- <select id="updateREPORT" parameterType="hashmap"> 
	<![CDATA[
	UPDATE REPORT
	SET
		REPORT_TITLE = #{REPORT_TITLE},
		REPORT_CATEGORY = #{REPORT_CATEGORY},
		REPORT_CONTENT = #{REPORT_CONTENT}
	WHERE REPORT_NUM = #{REPORT_NUM}
	]]>
</select>	

<select id="deleteREPORT" parameterType="hashmap"> 
	<![CDATA[
	DELETE REPORT
	WHERE REPORT_NUM = #{REPORT_NUM}
	]]>
</select>  -->
</mapper>